<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>MIA Nightclub System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="login-container">
    <h1 class="logo">MIA</h1>
    <p class="subtitle">nightclub system</p>

    <div class="login-box">
        <input type="text" id="usernameInput" placeholder="Benutzername">
        <input type="password" placeholder="Passwort">
        <button class="login-btn" id="loginBtn">Login</button>
        <button class="register-btn">Registrieren</button>
    </div>

    <div class="register-overlay" id="registerOverlay">
        <div class="register-box">
            <h2>Registrieren</h2>
            <input type="text" placeholder="Benutzername">
            <input type="password" placeholder="Passwort">
            <input type="password" placeholder="Passwort wiederholen">
            <button class="login-btn">Account erstellen</button>
            <button class="close-btn" id="closeRegister">Abbrechen</button>
        </div>
    </div>
</div>

<script>

/* ===========================
   SYSTEM DATA
=========================== */

const PERMISSIONS = {
    VIEW_INFO: "view_info",
    MANAGE_USERS: "manage_users"
};

const USERS = [
    { username: "melven", role: "god" },
    { username: "kevin", role: "superadmin" },
    { username: "lisa", role: "admin" },
    { username: "max", role: "barkeeper" },
    { username: "tom", role: "runner" }
];

let currentUser = null;

/* ===========================
   INIT
=========================== */

document.addEventListener("DOMContentLoaded", () => {

    const overlay = document.getElementById("registerOverlay");
    const registerBtn = document.querySelector(".register-btn");
    const closeBtn = document.getElementById("closeRegister");
    const loginBtn = document.getElementById("loginBtn");

    if (registerBtn) {
        registerBtn.addEventListener("click", () => {
            overlay.classList.add("active");
        });
    }

    if (closeBtn) {
        closeBtn.addEventListener("click", () => {
            overlay.classList.remove("active");
        });
    }

    if (overlay) {
        overlay.addEventListener("click", (e) => {
            if (e.target === overlay) {
                overlay.classList.remove("active");
            }
        });
    }

    if (loginBtn) {
        loginBtn.addEventListener("click", fakeLogin);
    }

});

/* ===========================
   LOGIN
=========================== */

function fakeLogin() {

    const usernameInput = document
        .getElementById("usernameInput")
        .value
        .toLowerCase();

    const foundUser = USERS.find(user => user.username === usernameInput);

    if (!foundUser) {
        alert("Unbekannter Benutzer");
        return;
    }

    currentUser = foundUser;
    showInfoScreen();
}

/* ===========================
   EVENT SCREEN
=========================== */

function showInfoScreen() {

    let EVENTS = JSON.parse(localStorage.getItem("mia_events")) || [
        {
            id: 1,
            title: "Techno Night",
            date: "2026-12-31",
            description: "Hard Techno & Neon Vibes",
            image: "https://picsum.photos/800/500?1"
        },
        {
            id: 2,
            title: "Latin Party",
            date: "2026-12-28",
            description: "Reggaeton & Latin Hits",
            image: "https://picsum.photos/800/500?2"
        }
    ];

    const today = new Date().toISOString().split("T")[0];

    EVENTS = EVENTS.filter(event => event.date >= today);
    EVENTS.sort((a,b) => new Date(a.date) - new Date(b.date));
    EVENTS = EVENTS.slice(0,6);

    localStorage.setItem("mia_events", JSON.stringify(EVENTS));

    document.body.innerHTML = `
        <div class="menu-overlay" id="menuOverlay"></div>

        <div class="top-bar">
            <div class="hamburger" onclick="toggleMenu()">☰</div>
        </div>

        <div class="side-menu" id="sideMenu">
            <div class="menu-header">MIA System</div>

            <div class="menu-item">Info</div>
            <div class="menu-item">Barkeeper</div>
            <div class="menu-item">Runner</div>
            <div class="menu-item">Getränkekarte</div>
            <div class="menu-item">Einstellungen</div>

            ${currentUser.role === "god" ? `<div class="menu-item god-mode">GOD Mode</div>` : ""}
            ${currentUser.role === "superadmin" || currentUser.role === "god" ? `<div class="menu-item">Mitarbeiter</div>` : ""}

            <div class="menu-divider"></div>
            <div class="menu-item logout-item" onclick="logout()">Logout</div>
        </div>

        <div class="event-container">
            ${EVENTS.map((event, index) => `
                <div class="event-card ${index === 0 ? "today" : ""}">
                    <div class="event-bg" style="background-image:url('${event.image}')"></div>
                    <div class="event-content">
                        <img src="${event.image}" class="event-image">
                        <h2>${event.title}</h2>
                        <p>${event.date}</p>
                        <p>${event.description}</p>
                    </div>
                </div>
            `).join("")}
        </div>
    `;
}

/* ===========================
   MENU
=========================== */

function toggleMenu() {
    const menu = document.getElementById("sideMenu");
    if (menu) {
        menu.classList.toggle("active");
    }
function logout() {
    closeMenu();
    currentUser = null;
    location.reload();
    }
    
}

</script>

</body>
</html>
