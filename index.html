<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>MIA Nightclub System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="login-container">
    <h1 class="logo">MIA</h1>
    <p class="subtitle">nightclub system</p>

    <div class="login-box">
        <input type="text" placeholder="Benutzername">
        <input type="password" placeholder="Passwort">
        <button class="login-btn" onclick="fakeLogin()">Login</button>
        <button class="register-btn">Registrieren</button>
    </div>

    <div class="register-overlay" id="registerOverlay">
        <div class="register-box">
            <h2>Registrieren</h2>
            <input type="text" placeholder="Benutzername">
            <input type="password" placeholder="Passwort">
            <input type="password" placeholder="Passwort wiederholen">
            <button class="login-btn">Account erstellen</button>
            <button class="close-btn" onclick="closeRegister()">Abbrechen</button>
        </div>
    </div>
</div>

<script>

/* ===========================
   REGISTER POPUP LOGIC
=========================== */

const overlay = document.getElementById("registerOverlay");

document.querySelector(".register-btn").addEventListener("click", () => {
    overlay.classList.add("active");
});

function closeRegister() {
    overlay.classList.remove("active");
}

overlay.addEventListener("click", (e) => {
    if (e.target === overlay) {
        closeRegister();
    }
});

/* ===========================
   SYSTEM KERNEL
=========================== */

const PERMISSIONS = {
    VIEW_INFO: "view_info",
    EDIT_INFO: "edit_info",
    MANAGE_USERS: "manage_users",
    EDIT_DRINKS: "edit_drinks",
    EDIT_SETTINGS: "edit_settings",
    ACCESS_BARKEEPER: "access_barkeeper",
    ACCESS_RUNNER: "access_runner"
};

const ROLES = {
    GOD: {
        name: "god",
        permissions: "ALL"
    },
    SUPERADMIN: {
        name: "superadmin",
        permissions: [
            PERMISSIONS.VIEW_INFO,
            PERMISSIONS.EDIT_INFO,
            PERMISSIONS.MANAGE_USERS,
            PERMISSIONS.EDIT_DRINKS,
            PERMISSIONS.EDIT_SETTINGS,
            PERMISSIONS.ACCESS_BARKEEPER,
            PERMISSIONS.ACCESS_RUNNER
        ]
    },
    ADMIN: {
        name: "admin",
        permissions: [
            PERMISSIONS.VIEW_INFO,
            PERMISSIONS.EDIT_INFO,
            PERMISSIONS.ACCESS_BARKEEPER,
            PERMISSIONS.ACCESS_RUNNER
        ]
    },
    BARKEEPER: {
        name: "barkeeper",
        permissions: [
            PERMISSIONS.VIEW_INFO,
            PERMISSIONS.ACCESS_BARKEEPER
        ]
    },
    RUNNER: {
        name: "runner",
        permissions: [
            PERMISSIONS.VIEW_INFO,
            PERMISSIONS.ACCESS_RUNNER
        ]
    }
};

const USERS = [
    { username: "melven", roles: ["god"] },
    { username: "kevin", roles: ["superadmin"] },
    { username: "lisa", roles: ["admin"] },
    { username: "max", roles: ["barkeeper"] },
    { username: "tom", roles: ["runner"] }
];

let currentUser = null;

function fakeLogin() {
    const usernameInput = document
        .querySelector('.login-box input[type="text"]')
        .value.toLowerCase();

    const foundUser = USERS.find(user => user.username === usernameInput);

    if (!foundUser) {
        alert("Unbekannter Benutzer");
        return;
    }

    buildUserSession(foundUser);
}

function buildUserSession(userData) {

    if (userData.roles.includes("god")) {
        currentUser = {
            username: userData.username,
            role: "god",
            permissions: "ALL"
        };
    } else {
        let collectedPermissions = [];

        userData.roles.forEach(roleName => {
            const role = Object.values(ROLES).find(r => r.name === roleName);
            if (role) {
                collectedPermissions.push(...role.permissions);
            }
        });

        currentUser = {
            username: userData.username,
            role: userData.roles[0],
            permissions: [...new Set(collectedPermissions)]
        };
    }

function showInfoScreen() {

    let EVENTS = JSON.parse(localStorage.getItem("mia_events")) || [
        {
            id: 1,
            title: "Techno Night",
            date: "2026-02-22",
            description: "Hard Techno & Neon Vibes",
            image: "https://picsum.photos/800/500?1"
        },
        {
            id: 2,
            title: "Latin Party",
            date: "2026-02-25",
            description: "Reggaeton & Latin Hits",
            image: "https://picsum.photos/800/500?2"
        }
    ];

    const today = new Date().toISOString().split("T")[0];

    // Alte Events entfernen
    EVENTS = EVENTS.filter(event => event.date >= today);

    // Nach Datum sortieren
    EVENTS.sort((a,b) => new Date(a.date) - new Date(b.date));

    // Maximal 6 Events
    EVENTS = EVENTS.slice(0,6);

    localStorage.setItem("mia_events", JSON.stringify(EVENTS));

    document.body.innerHTML = `
        <div class="event-container">
            ${EVENTS.map((event, index) => `
                <div class="event-card ${index === 0 ? "today" : ""}">
                    <div class="event-bg" style="background-image:url('${event.image}')"></div>
                    <div class="event-content">
                        <img src="${event.image}" class="event-image">
                        <h2>${event.title}</h2>
                        <p>${event.date}</p>
                        <p>${event.description}</p>
                    </div>
                </div>
            `).join("")}
        </div>
    `;
}

</script>

</body>
</html>
